# 腾讯云 Serverless 部署指南

## 前置条件

- Gitee 账号（已创建）
- GitHub 仓库（已有代码）
- 腾讯云账号（免费）

## 部署步骤

### 第一步：进入腾讯云 Serverless

1. 在 Gitee 仓库页面，点击服务列表中的 **"腾讯云 Serverless"**
2. 会跳转到腾讯云 Serverless 页面
3. 使用微信/手机扫码登录

### 第二步：创建应用

#### 1. 选择导入方式

选择 **"从 Gitee 导入"** 或 **"新建应用"**

#### 2. 配置应用信息

| 配置项 | 填写内容 |
|--------|---------|
| 应用名称 | `cloud-store-simulator` |
| 应用描述 | `云店模拟器 - 专业的店铺经营管理模拟工具` |
| 运行环境 | `Node.js` |
| Node.js 版本 | `18` 或 `20` |

### 第三步：配置构建

#### 构建命令

```bash
pnpm install
pnpm build
```

#### 输出目录

```
out
```

**注意：** 项目已配置为静态导出，会生成到 `out` 目录。

### 第四步：配置静态网站

选择 **"静态网站"** 模式：

- 静态网站目录：`out`
- 索引文件：`index.html`
- 错误页面：`404.html`（可选）

### 第五步：触发部署

1. 点击 **"创建"** 或 **"部署"** 按钮
2. 等待构建和部署完成（2-5 分钟）
3. 查看部署日志，确保没有错误

### 第六步：获取访问地址

部署成功后，腾讯云会提供访问地址，格式类似：

```
https://app-xxxxx.tcloudbaseapp.com
```

或：

```
https://cloud-store-simulator.xxxx.service.tcloudbase.com
```

**复制这个地址！**

### 第七步：测试访问

1. 在浏览器中测试访问新域名
2. 在微信中测试访问
3. 测试所有功能是否正常

### 第八步：添加微信验证文件

如果需要微信域名验证：

#### 方法一：在腾讯云添加验证文件

1. 进入腾讯云 Serverless 应用管理
2. 找到 **"静态网站"** 或 **"文件管理"**
3. 进入 `public` 目录
4. 创建新文件：
   - 文件名：`1bf87d91a9d9b4e3778681e93054e03a.txt`
   - 内容：`22f8d4e381575a977239b8ec83623e835ed69f2a`
5. 保存并重新部署

#### 方法二：从 GitHub/Gitee 同步

1. 确认验证文件已在 `public/` 目录
2. 代码已推送到 GitHub
3. 在 Gitee 仓库点击 **"同步"** 按钮
4. 腾讯云 Serverless 会自动拉取最新代码
5. 自动触发重新部署

### 第九步：微信域名验证

1. 访问：https://mp.weixin.qq.com
2. 进入域名验证页面
3. 输入腾讯云域名
4. 点击 **"验证"** 按钮
5. 等待验证通过

## 部署配置参考

### next.config.js（已修改）

```javascript
const nextConfig = {
  output: 'export',              // 静态导出
  images: {
    unoptimized: true,          // 禁用图片优化
    // ... 其他配置
  },
};
```

### package.json（已添加）

```json
{
  "scripts": {
    "build": "bash ./scripts/build.sh",
    "serve": "npx serve@latest out -p 5000"  // 新增
  }
}
```

## 优势

| 项目 | 说明 |
|------|------|
| 费用 | 免费额度够用 |
| 国内速度 | ⭐⭐⭐⭐⭐ 快 |
| 微信内访问 | ✅ 可以 |
| 自动部署 | ✅ 支持从 Gitee 同步 |
| 域名 | 腾讯云提供免费域名 |
| 自定义域名 | 支持（可选） |

## 注意事项

1. **免费额度**
   - 每月一定数量的请求和流量
   - 一般个人使用完全够用

2. **构建时间**
   - 每次部署需要重新构建
   - 大约 2-5 分钟

3. **同步代码**
   - 推送代码到 GitHub
   - 在 Gitee 点击同步
   - 腾讯云自动部署

4. **静态导出限制**
   - 不支持 SSR（服务端渲染）
   - 某些 Next.js 特性可能受限
   - 但本项目的所有功能都支持

## 故障排查

### 问题一：构建失败

**原因：** 依赖安装失败或构建命令错误

**解决方案：**
1. 检查部署日志，查看具体错误
2. 确认使用了 `pnpm install` 和 `pnpm build`
3. 检查 Node.js 版本是否正确

### 问题二：部署成功但 404

**原因：** 静态网站目录配置错误

**解决方案：**
1. 检查静态网站目录是否为 `out`
2. 确认构建成功生成了 `out` 目录
3. 重新部署

### 问题三：某些功能不工作

**原因：** 静态导出后，服务端 API 不可用

**解决方案：**
本项目是纯前端应用，不依赖服务端 API，应该没有问题。

如果遇到问题，检查：
- 客户端路由是否正确
- 本地存储是否正常
- 第三方 API 调用是否有 CORS 问题

## 下一步

部署成功后，您可以：

1. **使用免费域名**
   - 继续使用腾讯云提供的域名

2. **配置自定义域名**（可选）
   - 购买域名并配置到腾讯云
   - 获得更好的域名

3. **开启自定义 CDN**（可选）
   - 使用腾讯云 CDN 加速
   - 提升访问速度

## 联系支持

如果遇到问题：
- 腾讯云文档：https://cloud.tencent.com/document/product
- 腾讯云工单：在控制台提交工单
- Gitee 支持：https://gitee.com/help
