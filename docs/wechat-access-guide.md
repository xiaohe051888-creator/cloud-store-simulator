# 微信访问限制说明

## 问题现状

当前云店模拟器在微信内无法直接访问，会显示"如需浏览,请长按网址复制后使用浏览器访问"。

### 受影响的域名

- ❌ `cs5mtq7j5q.coze.site` (扣子编程预览域名)
- ❌ `cloud-store-simulator.pages.dev` (Cloudflare Pages域名)
- ❌ `*.pages.dev` (Cloudflare Pages所有子域名)

## 根本原因

微信对第三方托管平台（如 Cloudflare Pages、Vercel、Netlify 等）的域名有严格的安全限制：

1. **系统级拦截**：微信在页面加载前就拦截了这些域名
2. **域名白名单**：只有在微信公众平台配置过白名单的域名才能在微信内直接访问
3. **安全策略**：为了防止钓鱼网站和恶意链接，微信限制了非白名单域名的访问

## 当前解决方案

### 方案1：使用浏览器访问（推荐）

**步骤：**
1. 长按链接，复制到剪贴板
2. 退出微信，打开手机浏览器（Safari、Chrome等）
3. 在浏览器地址栏粘贴链接并访问

**优点：**
- 简单直接
- 无需额外配置
- 适用于所有用户

**缺点：**
- 需要手动操作
- 不够便捷

### 方案2：使用微信引导页面

**链接：** `https://cloud-store-simulator.pages.dev/wechat-redirect.html`

**说明：**
虽然这个页面也被微信拦截，但它的设计初衷是为用户提供详细的访问指引。

**注意：** 由于微信的系统级拦截，引导页面无法正常显示。

### 方案3：扫码访问（推荐）

使用手机浏览器扫描二维码访问，避开微信的限制。

**步骤：**
1. 点击页面右上角的"分享"按钮
2. 使用手机浏览器扫描弹出的二维码
3. 直接访问应用

**优点：**
- 绕过微信限制
- 便捷快速

## 长期解决方案

### 方案4：配置自定义域名（最推荐）

**步骤：**

1. **购买域名**
   - 在阿里云、腾讯云、Cloudflare等平台购买域名
   - 建议选择简短易记的域名，如 `cloudsimulator.com`

2. **域名备案**
   - 如果服务器在中国大陆，需要进行ICP备案
   - 如果服务器在海外，可以不需要备案

3. **配置到Cloudflare Pages**
   - 登录Cloudflare Dashboard
   - 进入项目设置 → Custom Domains
   - 添加自定义域名
   - 按照提示配置DNS记录

4. **申请微信域名白名单**
   - 注册微信公众号（服务号或订阅号）
   - 认证公众号（需要300元/年）
   - 在公众平台设置 → 功能设置 → JS接口安全域名
   - 添加自定义域名到白名单

**优点：**
- 微信内可直接访问
- 提升品牌形象
- 便于用户记忆

**缺点：**
- 需要购买域名（约10-100元/年）
- 需要时间配置和审核
- 可能需要备案费用

### 方案5：使用企业微信

企业微信对第三方域名的限制较少，可以尝试在企业微信中分享链接。

### 方案6：开发微信小程序

将应用功能移植到微信小程序，可以完全绕过域名限制。

**优点：**
- 微信内完美体验
- 无需域名限制

**缺点：**
- 需要重新开发
- 需要小程序账号和审核
- 维护成本高

## 代码层面的优化

已实现的优化：

1. ✅ **分享链接优化**：使用Cloudflare Pages主域名
2. ✅ **微信引导页面**：提供详细的访问指引
3. ✅ **QR码支持**：支持扫码访问
4. ✅ **访问提示**：在分享弹窗中添加微信访问限制提示
5. ✅ **自定义meta标签**：添加微信相关meta标签

## 用户操作指南

### 推荐操作流程

**场景1：电脑端分享给微信好友**

1. 点击"分享"按钮
2. 使用手机浏览器扫描二维码
3. 或复制链接：`https://cloud-store-simulator.pages.dev/`
4. 粘贴到浏览器访问

**场景2：微信内分享给好友**

1. 点击"分享"按钮
2. 复制链接：`https://cloud-store-simulator.pages.dev/`
3. 告诉好友：需要在浏览器中打开，不能直接在微信中打开

**场景3：快速访问**

1. 直接在浏览器中打开：`https://cloud-store-simulator.pages.dev/`
2. 添加到浏览器书签或主屏幕
3. 下次直接访问

## 常见问题

### Q1: 为什么不能在微信中直接打开？

A: 这是微信的安全策略，限制了第三方托管平台的域名。只有在微信公众平台配置过白名单的域名才能在微信内直接访问。

### Q2: 有办法绕过微信的限制吗？

A: 技术上无法绕过微信的系统级拦截。唯一的解决方案是配置自定义域名并申请微信白名单。

### Q3: 微信引导页面为什么也打不开？

A: 因为引导页面也托管在Cloudflare Pages上，同样被微信拦截。

### Q4: 什么时候能配置自定义域名？

A: 需要购买域名、配置DNS、申请白名单，整个过程需要1-7天。

### Q5: 有其他快速访问的方式吗？

A: 可以使用浏览器扫码访问，或将链接保存到浏览器书签中。

## 联系支持

如有问题，请通过以下方式联系：

- GitHub Issues: https://github.com/xiaohe051888-creator/cloud-store-simulator/issues
- 邮箱: support@example.com

## 更新日志

- 2024-01-22: 添加微信引导页面
- 2024-01-22: 优化分享链接，使用主域名
- 2024-01-22: 添加QR码支持
- 2024-01-22: 添加微信访问提示
